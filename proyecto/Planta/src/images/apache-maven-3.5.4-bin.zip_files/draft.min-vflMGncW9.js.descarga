define(["require","exports","draft-js","spectrum_comments/comment_editor/core/composer_wrappers","spectrum_comments/comment_editor/composers/active_macro_decorator","spectrum_comments/comment_editor/reducers/macros/activate_macro_composer","spectrum_comments/comment_editor/draft_utils"],function(e,t,r,n,o,c,i){"use strict";function a(e,t,r,n){t.findEntityRanges(function(t){var r=t.getEntity();return null!==r&&n.getEntity(r).getType()===e},r)}function s(e,t,s,u,p,m){function l(t){var r=t.innerProps;r.evt;return r.value.concat(m,[{strategy:a.bind(null,e),component:n.wrapComposerComponent(o.activeMacroDecorator),props:s}])}function f(r){r.kernel.compose(c.activateMacroComposer,{type:e,onMacro:u,delimiter:t})}function g(e){var r=(e.kernel,e.status),n=e.innerProps,o=n.evt,c=(n.value,r.macro);if(c.active&&39===o.which&&c.active.type==="macro: "+t){e.innerProps.value.getSelection().getAnchorOffset()>=c.active.endOffset&&(e.triggers.macro.apply(null),o.preventDefault())}}function v(e){var r=e.triggers,n=e.status,o=n.macro;o.active&&o.active.type==="macro: "+t&&r.macro.apply(null)}function d(n){var o=n.innerProps,c=o.evt,a=o.value,s=a.getSelection(),u=a.getCurrentContent(),m=u.getBlockForKey(s.getAnchorKey());if(t.lastIndexOf(c)!==t.length-1){var l=s.getAnchorOffset(),f=m.getEntityAt(l)||m.getEntityAt(l-1);if(null!==f&&u.getEntity(f).getType()===e){if(" "===c){var g=u;if(m.findEntityRanges(function(e){return e.getEntity()===f},function(e,t){var r=m.getText().substring(e,t);r.match(/\s/)&&(g=i.replaceText(u,s.getAnchorKey(),e,t,r))}),g!==u)return i.replaceContent(a,g)}var v=r.Modifier.replaceText(u,s,c,void 0,f);return i.replaceContent(a,v)}return a}var d=m.getText(),l=s.getAnchorOffset(),y=m.getEntityAt(l)||m.getEntityAt(l-1);if(null!==y&&0===u.getEntity(y).getType().indexOf("macro: ")){var v=r.Modifier.replaceText(u,s,c,void 0,y);return i.replaceContent(a,v)}var _=n.kernel.compose(p,{text:d,offset:l,input:c,delimiter:t});if(void 0!==_){var E=u.createEntity(e,"MUTABLE"),x=E.getLastCreatedEntityKey();return i.replaceContent(a,i.replaceText(u,m.getKey(),_.start,_.end,_.text,x))}}return void 0===m&&(m=[]),{decorators:{init:l},editorState:{change:f,key:g,returnKey:v,input:d}}}Object.defineProperty(t,"__esModule",{value:!0}),t.createDraftValuesReducers=s});
//# sourceMappingURL=draft.min.js-vflDaLjBo.map