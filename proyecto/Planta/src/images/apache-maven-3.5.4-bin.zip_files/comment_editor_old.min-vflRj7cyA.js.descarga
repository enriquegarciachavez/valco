define(["require","exports","tslib","react","spectrum_comments/comment_avatar","spectrum_comments/comment_editor/core/scope_component","spectrum_comments/comment_editor/types","react","classnames","spectrum_comments/comment_editor/core/scope_container","spectrum_comments/comment_editor/composers/draft_composer","spectrum_comments/comment_editor/reducers","draft-js","spectrum_comments/comment_editor/composers/post_signal","spectrum_comments/comment_editor/core/utils","spectrum_comments/comment_editor/core/composer_wrappers","spectrum_comments/comment_editor/comment_utils","spectrum_comments/comment_editor/composers/active_macro_chrome","spectrum_comments/comment_editor/reducers/macros/user_suggestion_composers"],function(e,t,o,n,s,r,c,i,a,m,u,p,d,l,f,h,g,C,_){"use strict";function S(e,t){return f.completeScope(y,e,t)}function v(e){var t=e.innerProps,o=(e.kernel,e.status),n=e.triggers,s=t.prevStatus;s&&o.draft.editorState===s.draft.editorState||n.draft.change(o.draft.editorState)}function R(e){var t=e.status,o=e.triggers,n=(e.innerProps,e.kernel);t.comment&&(o.draft.init(t.comment.content),n.compose(function(e){var t=d.EditorState.set(e.status.draft.editorState,{decorator:new d.CompositeDecorator(e.status.draft.decorators)});o.draft.change(t)}))}function E(e){var t=(e.status,e.triggers),o=(e.innerProps,e.kernel),n=o.compose(_.getSuggestedMentionUsers);n&&t.suggestion.updateTotalSuggestions(n.length)}Object.defineProperty(t,"__esModule",{value:!0});var y={draft:c.DraftNames,comment:c.CommentNames,macro:c.MacroNames,suggestion:c.SuggestionSelectionNames,mentionSuggestions:c.MentionSuggestionNames},M=(function(e){function t(t){var o=e.call(this,t)||this;return o.container=o.createCommentEditorScopeContainer(),o}return o.__extends(t,e),t.prototype.createBaseScope=function(e){return S(this.createBaseReducers().concat(e||[]),[{draft:v,comment:R,mentionSuggestions:E}])},t.prototype.createCommentEditorScopeContainer=function(){return new m.ScopeContainerImpl({scopeNames:y,defaultStatus:{draft:{editorState:d.EditorState.createEmpty(),readOnly:!1,placeholder:void 0===this.props.placeholder?"":this.props.placeholder,decorators:[]},comment:g.createCommentStatusFromContent(this.props.content),macro:{active:null,macroRef:null,isVisible:!0},suggestion:{selectedIndex:-1,totalSuggestions:0},mentionSuggestions:{userMap:this.props.mentionsMatches||{},users:[]}}})},t.prototype.createBaseReducers=function(){var e=this.props.onMentionsQueryUpdated||function(){};return[p.interactionReducers(),p.textReducers(),p.styleReducers()].concat(p.macrosReducers({onMentionSuggestionsQuery:e}),[p.suggestionReducers(),p.mentionReducers()])},t.prototype.componentDidMount=function(){this.props.shouldFocus&&this.editorRef&&this.editorRef.focus(),this.container.compose(R,S(this.createBaseReducers(),[]),{})},t.prototype.componentDidUpdate=function(e){var t=e.shouldFocus;this.props.shouldFocus&&!t&&this.editorRef&&this.editorRef.focus()},t.prototype.componentWillReceiveProps=function(e){var t=e.onContentChange,o=void 0===t?function(){}:t,n=e.onCancel,s=void 0===n?function(){}:n,r=e.onPost,c=void 0===r?function(){}:r,i=e.onFocus,a=void 0===i?function(){}:i,m=e.onBlur,u=void 0===m?function(){}:m,d={onContentChange:o,onCancel:s,onPost:c,onFocus:a,onBlur:u};e.content.text!==this.container.getStatus().comment.content.text&&this.container.updateStatus({comment:g.createCommentStatusFromContent(e.content)},this.createBaseScope([p.publishReducers(d)])),e.mentionsMatches!==this.props.mentionsMatches&&this.container.updateStatus({mentionSuggestions:{userMap:e.mentionsMatches||{},users:[]}},this.createBaseScope([p.publishReducers(d)]))},t.prototype.render=function(){var e=this,t=this.props,o=t.postSignalComponent,c=void 0===o?function(){return null}:o,i=t.onCancel,m=void 0===i?function(){}:i,d=t.onPost,f=void 0===d?function(){}:d,g=t.onContentChange,_=void 0===g?function(){}:g,S=t.onFocus,v=void 0===S?function(){}:S,R=t.onBlur,E=void 0===R?function(){}:R,y=t.className,M=t.author,B=h.wrapComposerComponent(u.draftComposer),N=h.wrapComposerComponent(C.activeMacroChrome),F=h.wrapComposerComponent(l.postSignal),P=this.createBaseScope([p.publishReducers({onCancel:m,onPost:f,onContentChange:_,onFocus:v,onBlur:E})]),b=a(y,{"sc-comment-editor":!0});return n.createElement("div",{className:b},n.createElement(r.BaseScopeComponent,{container:this.container,scope:P},n.createElement("div",{className:"sc-comment-editor-inner"},n.createElement("div",{className:"sc-comment-avatar"},n.createElement(s.CommentAvatar,{user:M})),n.createElement("div",{className:"sc-comment-editor-interaction-container"},n.createElement(B,{annotation:this.props.annotation,editorRef:function(t){e.editorRef=t}}),n.createElement(N,{scrollClassName:"sc-comment-editor-interaction-container"}))),n.createElement(F,{signalComponent:c})))},t})(i.Component);t.CommentEditor=M});
//# sourceMappingURL=comment_editor_old.min.js-vfl2NIk9G.map