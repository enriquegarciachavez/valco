define("modules/clean/avatar/triple_avatars",["require","exports","tslib","external/react","external/react-dom-factories","external/prop-types","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar","modules/clean/avatar/overflow_count_pill","modules/clean/avatar/size","modules/clean/react/css","modules/core/user_i18n"],function(e,t,o,r,n,s,a,i,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=o.__importStar(r),n=o.__importStar(n),s=o.__importStar(s),a=o.__importDefault(a),l=o.__importDefault(l),u=o.__importStar(u);var _=r.createElement,m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getPropTypes=function(){return{contacts:s.arrayOf(s.shape({email:s.string,display_name:s.string,photo_url:s.string})),count:s.number}},t.getAvatar=function(e){return _(a.default,{dimension:c.AVATAR_DIMENSION_BY_SIZE.XLARGE,photoUrl:e.photo_url,defaultAvatar:_(i.InitialsAvatarWithColorDerivedFromName,{dimension:c.AVATAR_DIMENSION_BY_SIZE.XLARGE,shape:"CIRCLE",initials:u.getInitials(e.display_name),name:e.display_name})})},t}return o.__extends(t,e),t.prototype.render=function(){var e=this;if(this.props.contacts&&0!==this.props.contacts.length){var t=this.props.contacts.length;return this.props.count&&this.props.count>this.props.contacts.length&&(t=this.props.count),n.div({className:"triple-avatars-section"},this.getAvatar(this.props.contacts[0]),this.props.contacts.length>1?this.getAvatar(this.props.contacts[1]):void 0,(function(){return 3===t?e.getAvatar(e.props.contacts[2]):t>3?_(l.default,{dimension:c.AVATAR_DIMENSION_BY_SIZE.XLARGE,count:t-2}):void 0})())}return n.div({})},t.displayName="TripleAvatars",t})(r.Component),p=d.requireCssWithComponent(m,["/static/css/scooter/scooter-scoped-vflrM1SRf.css"]);t.TripleAvatars=p}),define("modules/clean/multiaccount_login",["require","exports","tslib","jquery","modules/clean/dbmodal","modules/clean/teams/team_assume_user_personal_locked_modal","modules/clean/viewer","modules/core/browser","modules/core/controller_helpers","modules/core/exception","modules/core/i18n","modules/core/notify"],function(e,t,o,r,n,s,a,i,l,c,d,u){"use strict";return r=o.__importDefault(r),s=o.__importStar(s),i=o.__importStar(i),l=o.__importStar(l),(function(){function e(){}return e.$element=function(){return r.default("#db-modal-multiaccount-login-modal")},e.set_during_login_callback=function(e){return c.assert(!this._during_login_callback,"already have a during_login_callback"),this._during_login_callback=e},e.show_modal=function(e){var t=this;void 0===e&&(e={});var o,s;if(a.Viewer.get_viewer().is_team_assume_user_session)return this.show_personal_account_disabled_modal();this.$element=r.default.isFunction(this.$element)?this.$element():this.$element,c.assert(null!=this.$element&&!!this.$element.length,"MultiaccountLogin needs its @$element to be set"),c.assert(!(null!=e.on_success&&null!=e.success_href),"on_success and success_href are mutually exclusive"),null!=e.user?s=e.user:null!=e.user_id?s=a.Viewer.get_viewer().get_user_by_id(e.user_id,!0):null!=e.role&&(s=a.Viewer.get_viewer().get_user_by_role(e.role,!0)),c.assert(null!=s,"invalid user");var _=s.role;c.assert(!a.Viewer.get_viewer().is_user_signed_in(s),"called MultiaccountLogin for a user that's already signed in"),o="personal"===_?d._("Sign in to your personal Dropbox"):d._("Sign in to your %(team_name)s Dropbox").format({team_name:a.Viewer.get_viewer().team_name});var m=this.$element.find("form");return l.get_controller(m).reset(),l.get_controller(m).set_input_value("login_email",s.email),this.auth_success_callback=function(){a.Viewer.get_viewer()._sign_in_all_users();var o=function(o){return null!=o?(u.Notify.error(o),a.Viewer.get_viewer()._sign_out_user_by_id(s.id),void t.modal.hide()):null!=e.success_href?i.get_uri().toString()!==e.success_href?i.redirect(e.success_href):i.reload():(t.modal.hide(),"function"==typeof e.on_success?e.on_success():void 0)};return null!=t._during_login_callback&&null==e.success_href?t._during_login_callback(s,o):o(),!1},r.default(document).off("db:multilogin:success"),r.default(document).on("db:multilogin:success",this.auth_success_callback),this.modal=new n.DBModal({element_id:"multiaccount-login-modal"}),this.modal.show(),this.modal.set_title(o),this.$element.find('input[name="login_password"]').focus()},e.show_page_login_modal=function(e){for(var t=a.Viewer.get_viewer(),o=null,r=0,n=Array.from(t.get_users(!0));r<n.length;r++){var s=n[r];if(!t.is_user_signed_in(s)){o=s;break}}if(o){var i={user:o};return"string"==typeof e?i.success_href=e:"function"==typeof e&&(i.on_success=e),this.show_modal(i),!1}},e.show_personal_account_disabled_modal=function(){var e=a.Viewer.get_viewer();return s.AssumePersonalLockedModal.show({displayName:e.display_name,teamName:e.team_name}),!1},e})()}),define("modules/clean/sharing/api/mount_client",["require","exports","modules/clean/api_v2/root_aware_client"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){var t=e.userId;this.client=new o.UserActionsRootAwareClient,this.userId=t}return e.prototype.mount=function(e){var t=e.contentId;return this.client.ns("sharing").rpc("mount_folder",{shared_folder_id:String(t)},{subjectUserId:this.userId})},e})();t.MountFolderApiClient=r}),define("modules/clean/sharing/async_shared_content_link_sync_utils",["require","exports","tslib","modules/core/browser","modules/clean/sharing/shared_content_link_sync_utils","modules/clean/web_timing_logger"],function(e,t,o,r,n,s){"use strict";function a(){return!!window.__REGISTER_SYNC_VARS_PRELOAD}function i(){var e=window;return a()?new Promise(function(t,o){e.__REGISTER_SYNC_VARS_PRELOAD(function(e){t(e?JSON.parse(e):void 0)},o)}):Promise.resolve(void 0)}function l(e){return o.__awaiter(this,void 0,void 0,function(){var t,a;return o.__generator(this,function(o){switch(o.label){case 0:return s.log_js_modules_application_code_start(),[4,i()];case 1:return t=o.sent(),t&&t.redirect&&r.redirect(t.redirect_url),a=t||e.syncVars,n.showSharedContentSyncModal(e.activeUserId,a),[2]}})})}Object.defineProperty(t,"__esModule",{value:!0}),r=o.__importStar(r),s=o.__importStar(s),t.asyncSharedContentLinkSyncUtilsInitialize=l}),define("modules/clean/sharing/role_selector_modal",["require","exports","tslib","jquery","modules/clean/dbmodal","modules/clean/multiaccount_login","modules/clean/viewer"],function(e,t,o,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=o.__importDefault(r),s=o.__importDefault(s);var i=(function(e){function t(t){var o=e.call(this,{element_id:"select-role-modal-sync"})||this;return o.onSelectRole=t,o}return o.__extends(t,e),t.prototype.on_show=function(){var e=this;return r.default(".role-options li").click(function(t){var o=r.default(t.target).closest("li").data("role");return e.hide(),a.Viewer.get_viewer().is_role_signed_in(o)?e.onSelectRole(o):s.default.show_modal({role:o,on_success:function(){return e.onSelectRole(o)}})})},t})(n.DBModal);t.RoleSelectorModal=i}),define("modules/clean/sharing/shared_content_link_sync_modal",["require","exports","tslib","external/classnames","external/react","spectrum/button","spectrum-sharing/sharing_modal_banner","modules/clean/analytics","modules/clean/avatar/triple_avatars","modules/clean/em_string","modules/clean/filepath","modules/clean/growth/experiments/overquota_sharing_helper","modules/clean/history","modules/clean/loggers/growth_features_events_logger","modules/clean/react/async/loadable","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react_format","modules/clean/sharing/constants","modules/constants/sharing","modules/clean/sharing/views/hover_close_button","modules/clean/static_urls","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/payments","modules/core/browser","modules/core/i18n","modules/core/uri","modules/clean/react/overquota_modal_helpers"],function(e,t,o,r,n,s,a,i,l,c,d,u,_,m,p,h,g,f,v,y,w,b,S,N,T,E,x,O,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=o.__importDefault(r),n=o.__importStar(n),l=o.__importStar(l),d=o.__importStar(d),u=o.__importStar(u),_=o.__importDefault(_),m=o.__importStar(m),w=o.__importDefault(w),N=o.__importStar(N),T=o.__importStar(T),E=o.__importStar(E),x=o.__importStar(x);var A=x.i18n_default_project("sharing")._,C=(function(t){function x(r){var s=t.call(this,r)||this;return s.ASK="ask",s.ASKING="asking",s._closeSyncModal=function(){var e=s.props.outOfQuotaQP;if(e){var t=void 0;s.props.canRequestToJoin?(t={is_limited:s.state.ownerTeam&&s.state.ownerTeam.is_limited,ns_id:s.props.syncNSId,requested_team_id:s.state.ownerTeam?s.state.ownerTeam.id:void 0},m.logMagnetEvent("request_modal_OQ_dismissed",t)):s.props.magnetControlLogging&&(t={ns_id:s.props.syncNSId},m.logMagnetEvent("modal_OQ_dismissed")),i.NQOQLogger.logCloseModal(e,{modal_type:"billboard"}),s.logOutOfQuotaClose()}_.default.remove_query_param("sm"),s.refs.modal.close()},s._renderTopPanelIcon=function(){return s.props.targetFile?n.createElement(g.Sprite,{alt:"",group:"web",name:s.props.targetFile.icon}):n.createElement(g.Sprite,{alt:"",group:"web",name:"folder_user_32"})},s._renderTopPanelTitle=function(){return s.props.targetFile?c.Emstring.em_snippet(d.filename(s.props.targetFile.fq_path),15):c.Emstring.em_snippet(s.props.folderName,15)},s._renderTopPanelSubtitle=function(){return s.props.targetFile?s.props.ownerName?A("Owned by %(name)s").format({name:s.props.ownerName}):A("Not currently owned"):s.props.folderSize},s._renderAccessTextForOutOfQuota=function(){return s.props.canRequestToJoin?s.state.ownerTeam?n.createElement("div",null,n.createElement("div",{className:"content-link-sync-modal__access-text u-mar-top-m"},n.createElement(l.TripleAvatars,{contacts:s.state.ownerTeam.contacts,count:s.state.ownerTeam.count})),n.createElement("div",{className:"content-link-sync-modal__access-text"},A("Your Dropbox is fullâ€”join the %(team_name)s Dropbox?").format({team_name:s.state.ownerTeam.name}))):n.createElement("div",null):n.createElement("div",{className:"content-link-sync-modal__access-text"},A("Not enough space"))},s._renderAccessTextForSync=function(){return"can_view"===s.props.accessLevel?f.reactFormat(A("%(name)s (%(email)s) <br /> invited you to view this folder"),{name:s.props.senderName,email:s.props.senderEmail,br:n.createElement("br",null)}):f.reactFormat(A("%(name)s (%(email)s) <br /> invited you to edit this folder"),{name:s.props.senderName,email:s.props.senderEmail,br:n.createElement("br",null)})},s._renderAccessText=function(){return s.props.outOfQuotaQP?s._renderAccessTextForOutOfQuota():n.createElement("div",{className:"content-link-sync-modal__access-text"},s.props.senderName?s._renderAccessTextForSync():A("can_view"===s.props.accessLevel?"You have access to view this folder":"You have access to edit this folder"))},s._renderAccessTextOld=function(){return s.props.outOfQuotaQP?s.props.canRequestToJoin?s.state.ownerTeam?n.createElement("div",null,n.createElement("div",{className:"content-link-sync-modal__access-text u-mar-top-m"},n.createElement(l.TripleAvatars,{contacts:s.state.ownerTeam.contacts,count:s.state.ownerTeam.count})),n.createElement("div",{className:"content-link-sync-modal__access-text"},A("Your Dropbox is fullâ€”join the %(team_name)s Dropbox?").format({team_name:s.state.ownerTeam.name}))):n.createElement("div",null):n.createElement("div",{className:"content-link-sync-modal__access-text"},A("Not enough space")):n.createElement("div",{className:"content-link-sync-modal__access-text"},s.props.senderName?"can_view"===s.props.accessLevel?s.user.is_cdm_member?A("%(name)s invited you to view this folder").format({name:s.props.senderName}):A("%(name)s gave you access to view this folder").format({name:s.props.senderName}):s.user.is_cdm_member?A("%(name)s invited you to edit this folder").format({name:s.props.senderName}):A("%(name)s gave you access to edit this folder").format({name:s.props.senderName}):A("can_view"===s.props.accessLevel?"You have access to view this folder":"You have access to edit this folder"))},s._renderSharedFolderInfo=function(){return n.createElement("div",{className:"content-link-sync-modal__shared-folder-info"},n.createElement("div",{className:"content-link-sync-modal__shared-folder-text"},A((s.props.targetFile?s.props.targetFile.is_dir:void 0)?"This folder is part of a shared folder:":"This file is part of a shared folder:")),n.createElement("div",null,n.createElement(g.Sprite,{alt:"",group:"web",name:"folder_user_32"})),n.createElement("p",{className:"u-font-meta"},s.props.folderName,n.createElement("br",null),s.props.folderSize))},s._renderTipBody=function(e){return s.props.outOfQuotaQP?s.props.canRequestToJoin?s.state.ownerTeam?s.state.ownerTeam.contacts.length>0?A("Join %(name)s and your coworkers and get more space to work together.").format({name:s.state.ownerTeam.contacts[0].display_name}):null:n.createElement("img",{className:"content-link-sync-modal__loader",src:b.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:A("Loading")}):"V1"===s.props.expSubgrowthProShareUpsellModalFileAttr?A("To add this folder, youâ€™ll need more space in your Dropbox."):s.props.usageRemaining?A("To add this folder, youâ€™ll need %(needed)s of space in your Dropbox. You currently have %(remaining)s of space left.").format({remaining:s.props.usageRemaining,needed:s.props.usageNeeded}):A("To add this folder, youâ€™ll need %(needed)s of space in your Dropbox. You currently have no space left.").format({needed:s.props.usageNeeded}):A("Add it to Dropbox to start working together.",{comment:'"it" refers to the folder the user is trying to sync'})},s._renderTipBodyOld=function(e){return s.props.outOfQuotaQP?s.props.canRequestToJoin?s.state.ownerTeam?s.state.ownerTeam.contacts.length>0?A("Join %(name)s and your coworkers and get more space to work together.").format({name:s.state.ownerTeam.contacts[0].display_name}):null:n.createElement("img",{className:"content-link-sync-modal__loader",src:b.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:A("Loading")}):"V1"===s.props.expSubgrowthProShareUpsellModalFileAttr?A("To add this folder, youâ€™ll need more space in your Dropbox."):s.props.usageRemaining?A("To add this folder, youâ€™ll need %(needed)s of space in your Dropbox. You currently have %(remaining)s of space left.").format({remaining:s.props.usageRemaining,needed:s.props.usageNeeded}):A("To add this folder, youâ€™ll need %(needed)s of space in your Dropbox. You currently have no space left.").format({needed:s.props.usageNeeded}):s.state.state===s.ASKING?n.createElement("img",{src:b.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:A("Loading")}):!s.props.targetFile&&s.user.is_cdm_member?f.reactFormat(A("To get started, add this to <strong>%(cdm_tmf_name)s</strong> (your member folder). <a>Learn more</a>"),{cdm_tmf_name:e,strong:n.createElement("span",{className:"u-font-strong"}),a:n.createElement("a",{href:"/help/business/team-space-overview#acceptfolder",target:"_blank",rel:"noopener noreferrer"})}):A("can_view"===s.props.accessLevel?s.props.targetFile?"For easy access to this file in the future, add the folder to your Dropbox.":"For easy access to this folder in the future, add it to your Dropbox.":s.props.targetFile?"To start working on this file, you need to add the folder to your Dropbox first.":"To start working on this folder, you need to add it to your Dropbox first.")},s._renderPreviewLink=function(){return"can_view"===s.props.accessLevel?n.createElement("div",null,n.createElement("span",{className:"content-link-sync-modal__or"},A("Or")),n.createElement("button",{className:"content-link-sync-modal__not-now-label button-as-link",onClick:s.onPreviewButtonClicked},A(!s.props.targetFile||s.props.targetFile.is_dir?"preview this folder":"preview this file"))):null},s.logOutOfQuotaClose=function(){var e=N.start_time(),t=(new Date).getTime();i.ShareTibEventLogger.log(s.props.activeUserId,"OUT_OF_QUOTA_MODAL_CLOSE",v.SHARE_ACTION_ORIGIN_TYPE.SYNC_MODAL,{timing:t-e,ns_id:s.props.syncNSId})},s.onDismiss=function(){var e=s.props.outOfQuotaQP;e&&(i.NQOQLogger.logCloseModal(e,{modal_type:"billboard"}),s.logOutOfQuotaClose())},s._handleDismissText=function(){h.Modal.close(),s.onDismiss()},s.requestCallback=function(){var e=s.props.outOfQuotaQP,t=v.SHARE_ACTION_ORIGIN_TYPE.SYNC_MODAL;if(e){i.ShareTibEventLogger.log(s.props.activeUserId,"OUT_OF_QUOTA_MODAL_UPGRADE",t,{ns_id:s.props.syncNSId,usage_remaining:s.props.usageRemaining,usage_needed:s.props.usageNeeded});var o=void 0;s.props.canRequestToJoin?(o={is_limited:s.state.ownerTeam?s.state.ownerTeam.is_limited:void 0,ns_id:s.props.syncNSId,requested_team_id:s.state.ownerTeam?s.state.ownerTeam.id:void 0},m.logMagnetEvent("request_modal_OQ_click_upgrade",o)):s.props.magnetControlLogging&&(o={ns_id:s.props.syncNSId},m.logMagnetEvent("modal_OQ_CTA_click",o));var r="wb_nq_shm_share_w"===e||"wb_nq_shm_share_ro"===e?T.LOW_SPACE_URL:T.OUT_OF_SPACE_URL,n=new O.URI({path:r}).updateQuery({oqa:e});E.redirect(n.toString())}else s.props.targetFile&&i.ShareTibEventLogger.log(s.props.activeUserId,"UNMOUNTED_SEARCH_SYNC",t,{ns_id:s.props.syncNSId}),s.props.onMountSharedFolder()},s.onSyncButtonClicked=function(){if(s.setState({state:s.ASKING}),s.props.canRequestToJoin&&!s.props.outOfQuotaQP)s.activateRequestModal();else{var e=s.props.outOfQuotaQP;e&&i.NQOQLogger.logAcceptModal(e,{modal_type:"billboard",cta_text:"upgrade to add folder"}),s.requestCallback()}},s.onPreviewButtonClicked=function(){var e=s.props.outOfQuotaQP;if(e&&i.NQOQLogger.logPreviewLink(e,{modal_type:"billboard"}),s.props.previewCallback)i.ShareTibEventLogger.log(s.props.activeUserId,"UNMOUNTED_SEARCH_PREVIEW","SYNC_MODAL",{ns_id:s.props.syncNSId}),s.props.previewCallback();else{var t=s.props.previewUrl?O.URI.parse(s.props.previewUrl):E.get_uri().removeQuery("sm");t.updateQuery({from_sync_modal:!0}),E.redirect(t)}},s.onRequestButtonClicked=function(){s.setState({state:s.ASKING}),new Promise(function(t,o){e(["modules/clean/teams/membership_discovery_util"],t,o)}).then(o.__importStar).then(function(e){(0,e.sendTeamRequest)(s.state.ownerTeam.id,function(){return h.Modal.close()})});var t=S.Viewer.get_viewer().personal_user,r=t&&t.paid?"plus":"basic",n={folder_size:s.props.usageNeeded,is_limited:s.state.ownerTeam?s.state.ownerTeam.is_limited:void 0,ns_id:s.props.syncNSId,receiver_plan_type:r,receiver_quota_remaining:s.props.usageRemaining,requested_team_id:s.state.ownerTeam?s.state.ownerTeam.id:void 0};m.logMagnetEvent("request_modal_OQ_CTA_click",n)},s.activateRequestModal=function(){s.props.canRequestToJoin&&new Promise(function(t,o){e(["modules/clean/teams/membership_request_modal"],t,o)}).then(o.__importStar).then(function(e){var t=e.MembershipRequestModal;h.Modal.showInstance(n.createElement(t,{folderName:c.Emstring.em_snippet(s.props.folderName,15),nsId:s.props.syncNSId,overQuotaQP:null!=s.props.outOfQuotaQP,quotaNeeded:s.props.usageNeeded,quotaRemaining:s.props.usageRemaining,requestCallback:s.requestCallback,senderName:s.props.senderName,team:s.state.ownerTeam}))})},s.state={state:s.ASK,showX:!0},s}return o.__extends(x,t),x.showInstance=function(t){h.Modal.showInstance(t);var r=t.props.outOfQuotaQP;if(r){i.NQOQLogger.logViewModal(r,{modal_type:"billboard"});var n=t.props,s=n.expSubgrowthProShareUpsellModalFileAttr,a=n.expSubgrowthProShareModalIllustration,l=n.expSubgrowthProShmCtaCopy;s&&"OFF"!==s&&new Promise(function(t,o){e(["modules/clean/stormcrow/stormcrow_exposure_logger"],t,o)}).then(o.__importStar).then(function(e){var t=e.StormcrowExposureLogger,r=null;s&&"OFF"!==s&&(r={subgrowth_pro_share_upsell_modal_file_attr:s});var n=null;s&&"V2"===s&&a&&"OFF"!==a&&(n={subgrowth_pro_share_modal_illustration:a});var i=null;l&&"OFF"!==l&&(i={subgrowth_pro_shm_cta_copy:l}),(new t).logExposuresOnce(o.__assign({},r,n,i))})}},x.prototype.componentWillMount=function(){var e=N.start_time(),t=(new Date).getTime();this.user=S.Viewer.get_viewer().get_user_by_id(this.props.activeUserId);var r=v.SHARE_ACTION_ORIGIN_TYPE.SYNC_MODAL;if(this.props.outOfQuotaQP)i.ShareTibEventLogger.log(this.props.activeUserId,"OUT_OF_QUOTA_MODAL_RENDER",r,{timing:t-e,ns_id:this.props.syncNSId});else{var n=this.props.targetFile?"UNMOUNTED_SEARCH_MODAL_RENDER":"SYNC_MODAL_RENDER";i.ShareTibEventLogger.log(this.props.activeUserId,n,r,{timing:t-e,ns_id:this.props.syncNSId})}var s=this.props.expSubgrowthProShmCtaCopy;s&&"OFF"!==s&&this.setState(o.__assign({},this.state,u.getModalConfigSubgrowthProShmCtaCopy(s)))},x.prototype._renderDismissButton=function(){return this.state.secondaryCtaText&&this.state.secondaryCtaText.length?n.createElement("button",{className:"content-link-sync-modal__not-now-label button-as-link",onClick:this._handleDismissText},this.state.secondaryCtaText):null},x.prototype.render=function(){var e,t=r.default({"content-link-sync-modal":!0,"can-request-to-join-team":this.props.canRequestToJoin});this.user.is_cdm_member&&(e=d.filename(this.user.cdm_tmf_path));var o;o=y.SHARING_EXPERIMENTS.ENABLE_NEW_SYNC_MODAL_CONTENT?this.renderContent(e):this.renderContentOld(e);var s=this.props,a=s.expSubgrowthProShareUpsellModalFileAttr,i=s.outOfQuotaQP;return a&&i&&"V2"===a?this.renderOverquotaModal(i):n.createElement(h.Modal,{autoClose:!1,buttonComponent:this.renderButtons(e),className:t,clickOutToClose:!1,ref:"modal",showX:!1,title:"",onDismiss:this.onDismiss},o)},x.prototype.renderOverquotaModal=function(t){var r=p.Loadable({loader:function(){return new Promise(function(t,o){e(["modules/clean/react/overquota_modal"],t,o)}).then(o.__importStar).then(function(e){return e.OverquotaModal})}}),s=k.constructImageObject(this.props.expSubgrowthProShareModalIllustration),a=this.state,i=a.buttonText,l=a.buttonTextUntranslated,c=a.secondaryCtaText,d=a.showX;return n.createElement(r,{headline:A("Not enough space"),tagline:A("To add this folder, youâ€™ll need more space in your Dropbox."),oqa:t,imageObject:s,ctaText:i,ctaTextUntranslated:l,dismissText:c,showX:d})},x.prototype.renderContent=function(e){var t=this.state.showX;return n.createElement("div",{className:"content-link-sync-modal__content"},n.createElement("div",{className:"content-link-sync-modal__top-panel u-pad-s"},n.createElement("div",{className:"content-link-sync-modal__icon u-pad-top-xs"},this._renderTopPanelIcon()),n.createElement("div",{className:"content-link-sync-modal__name-size u-l-ib u-pad-left-xs u-pad-top-xs o-flag__flex"},n.createElement("h3",{className:"u-font-strong"},this._renderTopPanelTitle()),n.createElement("h4",{className:"u-trim-margin u-font-meta"},this._renderTopPanelSubtitle())),t&&n.createElement("div",{className:"content-link-sync-modal__close u-pad-xs o-flag__fix"},n.createElement(w.default,{onClick:this._closeSyncModal}))),this.props.senderIsOffTeam&&!this.props.outOfQuotaQP&&!this.props.targetFile&&n.createElement(a.SharingModalBanner,{borderHidden:!0,className:"content-link-sync-modal__off-team-warning",message:A("This person is outside your Dropbox team."),type:"warn"}),n.createElement("div",{className:"content-link-sync-modal__tip-panel u-pad-top-m u-pad-horizontal-m"},this.props.targetFile?this._renderSharedFolderInfo():this._renderAccessText(),n.createElement("div",{className:"content-link-sync-modal__tip-body"},this._renderTipBody(e))))},x.prototype.renderContentOld=function(e){var t=this.state.showX;return n.createElement("div",{className:"content-link-sync-modal__content"},n.createElement("div",{className:"content-link-sync-modal__top-panel u-pad-s"},n.createElement("div",{className:"content-link-sync-modal__icon u-pad-top-xs"},this._renderTopPanelIcon()),n.createElement("div",{className:"content-link-sync-modal__name-size u-l-ib u-pad-left-xs u-pad-top-xs o-flag__flex"},n.createElement("h3",{className:"u-font-strong"},this._renderTopPanelTitle()),n.createElement("h4",{className:"u-trim-margin u-font-meta"},this._renderTopPanelSubtitle())),t&&n.createElement("div",{className:"content-link-sync-modal__close u-pad-xs o-flag__fix"},n.createElement(w.default,{onClick:this._closeSyncModal}))),n.createElement("div",{className:"content-link-sync-modal__tip-panel u-pad-top-m u-pad-right-l u-pad-left-l"},this.props.targetFile?this._renderSharedFolderInfo():this._renderAccessTextOld(),n.createElement("div",{className:"content-link-sync-modal__tip-body"},this._renderTipBodyOld(e))))},x.prototype.renderButtons=function(e){if(this.props.canRequestToJoin&&this.props.outOfQuotaQP)return this.state.ownerTeam?n.createElement("div",{className:"content-link-sync-modal__buttons u-pad-m"},this.props.outOfQuotaQP?n.createElement("div",null,!this.state.ownerTeam.is_limited&&n.createElement(s.Button,{className:"content-link-sync-modal__request-to-join-button",disabled:this.state.state===this.ASKING,onClick:this.onRequestButtonClicked,variant:"primary"},A("Request to join")),n.createElement(s.Button,{className:"content-link-sync-modal__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onSyncButtonClicked,variant:this.state.ownerTeam.is_limited?"primary":"secondary"},A("Upgrade to add folder")),"can_view"===this.props.accessLevel?this._renderPreviewLink():void 0):void 0):n.createElement("div",null);var t=this.props.outOfQuotaQP?A("Upgrade to add folder"):this.props.targetFile?this.user.is_cdm_member?this.getButtonTextForCDM(e):A("Add folder to Dropbox"):this.user.is_cdm_member?this.getButtonTextForCDM(e):A("Add to Dropbox");return this.state.buttonText&&(t=this.state.buttonText),n.createElement("div",{className:"content-link-sync-modal__buttons u-pad-m"},n.createElement(s.Button,{className:"content-link-sync-modal__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onSyncButtonClicked,variant:"primary"},t),"can_view"===this.props.accessLevel?this._renderPreviewLink():void 0,this._renderDismissButton())},x.prototype.getButtonTextForCDM=function(e){return this.props.targetFile?e.length>9?A("Add folder to my member folder"):f.reactFormat(A("Add folder to <strong>%(cdm_tmf_name)s</strong> folder"),{cdm_tmf_name:e,strong:n.createElement("strong",{style:{fontWeight:800}})}):e.length>17?A("Add to my member folder"):f.reactFormat(A("Add to <strong>%(cdm_tmf_name)s</strong> folder"),{cdm_tmf_name:e,strong:n.createElement("strong",{style:{fontWeight:800}})})},x.prototype.componentDidMount=function(){var t,r=this;N.mark_time_to_interactive();var n=S.Viewer.get_viewer().personal_user,s=n&&n.paid?"plus":"basic";this.props.canRequestToJoin&&(new Promise(function(t,o){e(["modules/clean/teams/membership_discovery_util"],t,o)}).then(o.__importStar).then(function(e){var t=e.getDiscoverableTeamForFolder;r.setState({state:r.ASKING}),t(r.props.syncNSId,function(e){r.setState({state:r.ASK,ownerTeam:e})})}),this.props.outOfQuotaQP&&(t={folder_size:this.props.usageNeeded,is_limited:this.state.ownerTeam?this.state.ownerTeam.is_limited:void 0,ns_id:this.props.syncNSId,receiver_plan_type:s,receiver_quota_remaining:this.props.usageRemaining,requested_team_id:this.state.ownerTeam?this.state.ownerTeam.id:void 0},m.logMagnetEvent("request_modal_OQ_open",t))),this.props.magnetControlLogging&&this.props.outOfQuotaQP&&(t={folder_size:this.props.usageNeeded,ns_id:this.props.syncNSId,receiver_plan_type:s,receiver_quota_remaining:this.props.usageRemaining},m.logMagnetEvent("modal_OQ_open",t))},x.displayName="SharedContentLinkSyncModal",x.defaultProps={canRequestToJoin:!1,magnetControlLogging:!1},x})(n.Component);t.SharedContentLinkSyncModal=C}),define("modules/clean/sharing/shared_content_link_sync_utils",["require","exports","tslib","external/react","modules/clean/sharing/shared_content_link_sync_modal","modules/core/browser","modules/clean/web_timing_logger"],function(e,t,o,r,n,s,a){"use strict";function i(){return o.__awaiter(this,void 0,void 0,function(){var t;return o.__generator(this,function(r){switch(r.label){case 0:return[4,new Promise(function(t,o){e(["modules/clean/sharing/shared_content_link_mount_folder"],t,o)}).then(o.__importStar)];case 1:return t=r.sent().mountSharedFolder,[2,t]}})})}function l(e,t,l){if(void 0===l&&(l=null),t&&t.sync_ns_id){var c=t.sync_owner_name||t.ownerName,d=function(){return o.__awaiter(this,void 0,void 0,function(){var e;return o.__generator(this,function(o){switch(o.label){case 0:return[4,i()];case 1:return e=o.sent(),e(t.sync_ns_id,t.sync_role,"SYNC_MODAL",!0,l),[2]}})})};a.waitForTTI().then(i),n.SharedContentLinkSyncModal.showInstance(r.createElement(n.SharedContentLinkSyncModal,{activeUserId:e,accessLevel:t.access_level,canRequestToJoin:t.can_request_to_join,expSubgrowthProShareUpsellModalFileAttr:t.exp_subgrowth_pro_share_upsell_modal_file_attr,expSubgrowthProShareModalIllustration:t.exp_subgrowth_pro_share_modal_illustration,expSubgrowthProShmCtaCopy:t.exp_subgrowth_pro_shm_cta_copy,folderName:t.sync_folder_name,folderSize:t.sync_folder_size,magnetControlLogging:t.magnet_control,outOfQuotaQP:t.sync_out_of_quota_qp,usageRemaining:t.sync_usage_remaining,usageNeeded:t.sync_usage_needed,senderName:t.sync_sender_name,senderEmail:t.sync_sender_email,senderIsOffTeam:t.sync_sender_is_off_team,ownerName:c,targetFile:l,previewCallback:null!=l?s.redirect.bind(s,t.sync_preview_url):void 0,previewUrl:t.sync_preview_url,onMountSharedFolder:d,syncNSId:t.sync_ns_id,ownerProfilePhotoUrl:t.ownerProfilePhotoUrl}))}}Object.defineProperty(t,"__esModule",{value:!0}),r=o.__importStar(r),s=o.__importStar(s),t.showSharedContentSyncModal=l}),define("modules/clean/teams/team_assume_user_personal_locked_modal",["require","exports","tslib","external/react","external/react-dom-factories","external/prop-types","modules/clean/react/modal","modules/core/i18n","modules/clean/react/css"],function(e,t,o,r,n,s,a,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=o.__importStar(r),n=o.__importStar(n),s=o.__importStar(s);var c=r.createElement,d=(function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t._close=function(e){return e.preventDefault(),a.Modal.close()},t._getModalProps=function(){return{title:i._("Personal account not accessible"),acceptButtonText:i._("Close"),dismissButtonText:null,onAccept:t._close}},t}return o.__extends(r,e),r.show=function(e){return a.Modal.showInstance(c(t.AssumePersonalLockedModal,e))},r.prototype.render=function(){return c(a.Modal,this._getModalProps(),n.div({className:"team-assume-user-modal"},i._("%(display_name)sâ€™s personal account isnâ€™t managed by the %(team_name)s team, so its contents arenâ€™t accessible to admins.").format({display_name:this.props.displayName,team_name:this.props.teamName})))},r.displayName="AssumePersonalLockedModal",r.propTypes={displayName:s.string,teamName:s.string},r})(r.Component);t.AssumePersonalLockedModal=l.requireCssWithComponent(d,["/static/css/team_assume_user_modal-vflwnEaEu.css"])});
//# sourceMappingURL=pkg-sharing-sync.min.js-vfl7iIvMd.map