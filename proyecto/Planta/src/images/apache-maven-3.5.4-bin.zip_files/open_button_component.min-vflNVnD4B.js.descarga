define(["require","exports","tslib","external/lodash","external/react","external/classnames","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/open_button/coachmark_wrapper","modules/clean/react/file_viewer/open_button/utils","modules/clean/react/file_viewer/open_button/types","modules/clean/react/paper/open_in_paper_button","modules/clean/react/file_viewer/unity/with_unity","modules/clean/react/file_viewer/utils","modules/core/i18n","react-dom","modules/clean/react/paper/open_in_paper_callout_loader","modules/clean/react/paper/utils","modules/clean/react/size_class/constants","spectrum/button","spectrum/popover","modules/clean/react/sprite_div"],function(e,t,n,o,i,r,a,p,l,s,u,c,d,h,m,f,_,C,y,b,v,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o),i=n.__importStar(i),r=n.__importDefault(r),f=n.__importStar(f),O=n.__importDefault(O);var P=(S={},S[u.OpenButtonAction.DOWNLOAD]="open-button__download",S[u.OpenButtonAction.UNITY_FILE]="open-button__unity",S[u.OpenButtonAction.UNITY_FOLDER]="open-button__unity-folder",S[u.OpenButtonAction.OPEN_WITH]="open-button__open-with",S),E=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasBeenClicked:!1},t.getCopyToPaperExperimentVariant=o.once(function(){C.getPaperExperimentsPostTTI(t.props.user).then(function(e){t.setState({copyToPaperExperimentVariant:e.paper_copy_to_paper_filesizes})})}),t.handleActionClick=function(e,n){t.handleClick(),t.props.onClick&&t.props.onClick(),e.handler();var o=h.getSplitButtonUserActionContext(n,t.props.location);a.logUserAction(e.userAction,o)},t.handleClick=function(){t.setState({hasBeenClicked:!0})},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.checkCopyToPaperExperimentVariant()},t.prototype.componentDidUpdate=function(){this.checkCopyToPaperExperimentVariant()},t.prototype.checkCopyToPaperExperimentVariant=function(){C.fileSupportsCopyToPaper(this.props.file)&&this.getCopyToPaperExperimentVariant()},t.prototype.isOpenInPaperSupported=function(){return!!this.props.hasOpenInPaperSupport&&C.fileSizeWithinExperimentLimits(this.props.file,this.state.copyToPaperExperimentVariant)},t.prototype.render=function(){var e=this,t=this.props,n=t.file,o=t.buttonVariant,r=t.isUnityDisabled,a=t.isOpenWithDisabled,p=t.unityInfo,u=t.sizeClass,c=t.user,d=this.state.hasBeenClicked,h=s.getOpenOptions({file:n,hasOpenInPaperSupport:this.isOpenInPaperSupported(),isUnityDisabled:r,isOpenWithDisabled:a,unityInfo:p,user:c});return i.createElement("div",{className:"open-button",ref:function(t){e.ref=f.findDOMNode(t)}},i.createElement(l.OpenButtonCoachmarkWrapper,{inDropdown:1!==h.length,file:n,user:c,shouldShowCoachmark:s.shouldShowCoachmark(h,p)&&!d},0===h.length?i.createElement(B,{buttonVariant:o}):1===h.length?i.createElement(D,{file:n,buttonVariant:o,onClick:this.handleActionClick,option:h[0],user:c}):i.createElement(g,{file:n,buttonVariant:o,onItemClick:this.handleActionClick,onTriggerClick:this.handleClick,options:h,user:c,sizeClass:u})),this.isOpenInPaperSupported()?i.createElement(_.OpenInPaperCalloutLoader,{file:n,parentHasBeenClicked:d,sizeClass:u,targetNode:this.ref,user:c,variant:C.OpenInPaperButtonVariant.Dropdown}):null)},t.defaultProps={isUnityDisabled:!1,isOpenWithDisabled:!1,justifyRight:!0,buttonVariant:"secondary"},t})(i.Component);t._OpenButton=E;var k=function(e){var t=e.option,n=e.file,o=e.user,r=t.type;return i.createElement(v.PopoverContentItem,{key:t.text,value:t},r===u.OpenButtonAction.OPEN_IN_PAPER?i.createElement(c.OpenInPaperButton,{file:n,user:o,inDropdown:!0,hideCallout:!0}):i.createElement(O.default,{group:"web",name:t.spriteName,text:t.text}))},g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePopoverSelection=function(e,n){n&&(n.preventDefault(),n.stopPropagation()),t.props.onItemClick&&t.props.onItemClick(e,p.SplitButtonActionLocation.Split)},t}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.sizeClass;return i.createElement(v.Popover,{onSelection:this.handlePopoverSelection},i.createElement(v.PopoverTrigger,null,i.createElement(b.Button,{className:r.default("download-button","control__button"),onClick:this.props.onTriggerClick,tagName:"span",variant:this.props.buttonVariant,size:t===y.SizeClass.Small?"large":"default"},m._("Open â–¾"))),i.createElement(v.PopoverContent,{attachment:"right"},this.props.options.map(function(t){return i.createElement(k,{option:t,file:e.props.file,user:e.props.user})})))},t})(i.Component),D=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){e.preventDefault(),e.stopPropagation(),t.props.onClick&&t.props.onClick(t.props.option,p.SplitButtonActionLocation.Main)},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.option,t=e.type;return t===u.OpenButtonAction.OPEN_IN_PAPER?i.createElement(c.OpenInPaperButton,{file:this.props.file,user:this.props.user,inDropdown:!1,hideCallout:!0}):i.createElement(b.Button,{className:"control__button "+P[t],variant:this.props.buttonVariant,onClick:this.handleClick},t===u.OpenButtonAction.DOWNLOAD?m._("Download"):m._("Open"))},t})(i.Component),B=function(e){var t=e.buttonVariant;return i.createElement(b.Button,{"aria-label":m._("Disabled open button"),className:"control__button",disabled:!0,variant:t})},I=function(e){return i.createElement(d.WithUnity,{file:e.file,isUnityDisabled:e.isUnityDisabled,user:e.user,render:function(t){return i.createElement(E,n.__assign({},e,{unityInfo:t}))}})};t.OpenButton=I;var S});
//# sourceMappingURL=open_button_component.min.js-vfl9PBVTl.map