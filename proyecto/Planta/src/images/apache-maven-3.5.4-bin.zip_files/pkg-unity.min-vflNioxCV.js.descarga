define("modules/clean/unity/check_file_cache",["require","exports","tslib","modules/clean/unity/features"],function(e,t,n,_){"use strict";_=n.__importDefault(_);var i=(function(){function e(){}return e.initClass=function(){this._cache={}},e.is_cached_and_locally_available=function(e,t){var n=this._cache[_.default.server_path(e,t)];return null!=n&&n.is_locally_available},e.get=function(e,t){return this._cache[_.default.server_path(e,t)]},e.set=function(e,t){return this._cache[e]=t},e.set_batch=function(e){var t=this;return(function(){var n=[];for(var _ in e){var i=e[_];n.push(t._cache[_]=i)}return n})()},e.clear=function(){return this._cache={}},e})();i.initClass();var r=i;return null==_.default&&(r=void 0),r}),define("modules/clean/unity/connection",["require","exports","tslib","jquery","modules/clean/ajax","modules/clean/unity/connection_error","modules/clean/unity/logger","modules/clean/unity/versions","modules/clean/unity/web_socket","modules/clean/unity/websocket_config","modules/clean/viewer","modules/constants/unity","modules/core/exception","modules/core/uri"],function(e,t,n,_,i,r,s,o,a,u,l,c,d,h){"use strict";_=n.__importDefault(_),i=n.__importStar(i),r=n.__importDefault(r),s=n.__importDefault(s),o=n.__importDefault(o),a=n.__importDefault(a),u=n.__importDefault(u),c=n.__importStar(c),d=n.__importStar(d);var f=(function(){function e(){this._on_close=this._on_close.bind(this),this._on_error=this._on_error.bind(this),this._set_connection_state=this._set_connection_state.bind(this),this._on_message=this._on_message.bind(this),this._on_response_timeout=this._on_response_timeout.bind(this),this.client_version=null,this._on_open_callbacks=[],this._on_open_failed_callbacks=[],this._on_close_callbacks=[],this._pending_callbacks=[],this._response_callbacks={},this._ws=null,this._port=null,this._active_ports={},this._connection_state=e._CONNECTION_PENDING,this._current_message_id=1,this._permission_level=null,this.logger=new s.default,this._routes={check_unity_version:this._check_unity_version.bind(this),fetch_unity_nonce:this._fetch_unity_nonce.bind(this),complete_handshake:this._complete_handshake.bind(this)}}return e.initClass=function(){this._CONNECTION_OPENED_STATE=0,this._VERSION_CHECK_STATE=1,this._FETCHING_NONCE_STATE=2,this._NONCE_RETURNED_TO_CLIENT_STATE=3,this._HANDSHAKE_COMPLETED_STATE=4,this._CONNECTION_PENDING=0,this._CONNECTION_ESTABLISHED=1,this._CONNECTION_CLOSED=2,this._CONNECTION_RETRYING=3,this._RESPONSE_TIMEOUT=5e3,this._MIN_PORT=17600,this._MAX_PORT=17602,this.SECURE_PERMISSION="secure",this.INSECURE_WEB_PERMISSION="insecure_web",this.INSECURE_CLIENT_PERMISSION="insecure_client",this.INSECURE_PERMISSION="insecure"},e.prototype.start=function(){return u.default.canUnityConnect()&&a.default.load_flash_policy_if_needed()?this._attempt_handshake():(this._set_connection_state(e._CONNECTION_CLOSED),void this.logger.report_event("unity_failure",{message:"WebSocket creation failed. Not able to create web socket."}))},e.prototype._attempt_handshake=function(){var t;try{var n=void 0,_=void 0;for(t=e._MIN_PORT,_=e._MAX_PORT,n=e._MIN_PORT<=_;n?t<=_:t>=_;n?t++:t--){this._active_ports[t]=!0;var i={scheme:"ws",authority:"127.0.0.1:"+t.toString(),path:"/ws"},r=a.default.create(new h.URI(i).toString());r.onmessage=this._on_message({ws:r,port:t,state:e._CONNECTION_OPENED_STATE,client_version:null,client_has_auth:null}),r.onclose=this._on_close(t),r.onerror=this._on_error(t)}}catch(n){this.logger.report_event("unity_failure",{message:"WebSocket creation failed. Message: "+n.message,error_name:n.name,port:t}),this._set_connection_state(e._CONNECTION_CLOSED)}return this.logger.report_event("handshake_started")},e.prototype._on_close=function(e){var t=this;return function(n){return[1e3,1001,1005,1006].includes(n.code)||t.logger.report_event("unity_failure",{message:"WebSocket closed. Code: "+n.code+". Reason: "+n.reason,port:e}),t._close_port(e)}},e.prototype._on_error=function(e){var t=this;return function(n){return t.logger.report_event("unity_failure",{message:"WebSocket error. Message: "+n.data,port:e}),t._close_port(e)}},e.prototype._close_port=function(t){if(t in this._active_ports&&(delete this._active_ports[t],_.default.isEmptyObject(this._active_ports)))return this._connection_state===e._CONNECTION_ESTABLISHED?this._retry_connection():this._set_connection_state(e._CONNECTION_CLOSED)},e.prototype._retry_connection=function(){return this.logger.report_event("connection_retrying"),this._set_connection_state(e._CONNECTION_RETRYING),this.client_version=this._ws=this._port=null,this._attempt_handshake()},e.prototype._set_connection_state=function(t){var n=this;if(t!==this._connection_state){var _=this._connection_state;if(d.assert(_!==e._CONNECTION_CLOSED,"Shouldn't unclose a closed connection."),this._connection_state=t,t===e._CONNECTION_ESTABLISHED){if(d.assert(this._is_connection_in_progress(_),"Can only establish from pending or retrying."),this.logger.report_event("handshake_complete"),_===e._CONNECTION_PENDING)for(var i=0,s=Array.from(this._on_open_callbacks);i<s.length;i++){var o=s[i];o()}return(function(){for(var e=[];n._pending_callbacks.length;){var t=Array.from(n._pending_callbacks.pop()),_=t[0],i=t[1];n.is_ready()?e.push(_()):e.push("function"==typeof i?i(r.default.UNEXPECTED_ERROR):void 0)}return e})()}if(t!==e._CONNECTION_RETRYING){if(t===e._CONNECTION_CLOSED){if(_===e._CONNECTION_PENDING){this.logger.report_event("connection_not_established");for(var a=0,u=Array.from(this._on_open_failed_callbacks);a<u.length;a++){(0,u[a])()}}else if(_===e._CONNECTION_RETRYING){this.logger.report_event("connection_terminated");for(var l=0,c=Array.from(this._on_close_callbacks);l<c.length;l++){var h=c[l];h()}}else d.assert(!1,"CONNECTION_CLOSED can only be set from PENDING or RETRYING");return(function(){for(var e=[];n._pending_callbacks.length;){var t=Array.from(n._pending_callbacks.pop()),_=t[1];e.push("function"==typeof _?_(r.default.CONNECTION_CLOSED):void 0)}return e})()}return d.assert(!1,"Changing connection_state to CONNECTION_PENDING not supported.")}}},e.prototype._on_message=function(e){var t=this;return function(n){var _=JSON.parse(n.data);if(null==_.func||null==(null!=_.header?_.header.message_id:void 0)||null==(null!=_.header?_.header.should_respond:void 0))return void t._terminate_handshake(e.ws,"Malformed message from client.",{message:n.data});if(null!=(null!=_.header?_.header.log_data:void 0)&&t.logger.update(_.header.log_data),t.logger.update({port:e.port}),"response"===_.func)return t._on_response(_.header.message_id,_.data);var i=t._routes[_.func];if(null==i)return void t._terminate_handshake(e.ws,"Unknown function.",{function:_.func});var r=t.is_ready()?i(_.data):i(e,_.data);return _.header.should_respond?t.send("response",r,null,null,_.header.message_id):void 0}},e.prototype.send=function(e,t,n,_,i){return void 0===t&&(t=null),void 0===n&&(n=null),void 0===_&&(_=null),void 0===i&&(i=null),this._send_with_ws(this._ws,e,t,n,_,i)},e.prototype._send_with_ws=function(t,n,_,i,s,o){if(void 0===_&&(_=null),void 0===i&&(i=null),void 0===s&&(s=null),void 0===o&&(o=null),null==o&&(o=this._current_message_id,d.assert(this._current_message_id%2===1,"Web-initiated message_ids should remain odd"),this._current_message_id+=2),null!==i){var a=window.setTimeout(this._on_response_timeout(o),e._RESPONSE_TIMEOUT);this._response_callbacks[o]=[i,s,a]}var u={func:n,header:{message_id:o,should_respond:null!==i,log_data:this.logger.get_log_data_for_client()}};null!=_&&(u.data=_);try{return t.send(JSON.stringify(u))}catch(e){return this.logger.report_event("unity_failure",{message:"WebSocket send failed. Message: "+e.message,error_name:e.name}),"function"==typeof s?s(r.default.COULD_NOT_SEND):void 0}},e.prototype._on_response=function(e,t){if(e in this._response_callbacks){var n=Array.from(this._response_callbacks[e]),_=n[0],i=n[2];return delete this._response_callbacks[e],window.clearTimeout(i),_(t)}},e.prototype._on_response_timeout=function(e){var t=this;return function(){var n;return _=Array.from(t._response_callbacks[e]),_[0],n=_[1],_[2],delete t._response_callbacks[e],"function"==typeof n?n(r.default.CONNECTION_TIMEOUT):void 0;var _}},e.prototype._check_unity_version=function(t,n){if(t.state!==e._CONNECTION_OPENED_STATE)return void this._terminate_handshake(t.ws,"Handshake version check at wrong time of protocol.");if(t.state=e._VERSION_CHECK_STATE,t.client_version=n.client_version,n.client_version<o.default.UNITY_HANDSHAKE)return void this._terminate_handshake(t.ws,"Client version is too old.");var _=l.Viewer.get_viewer().is_signed_in;return n.client_version<o.default.PERMISSION_LEVELS&&!_?void this._terminate_handshake(t.ws,"Client version is too old to support insecure web connections."):(this.logger.report_event("handshake_version_check"),n.client_version>=o.default.PERMISSION_LEVELS?this._send_with_ws(t.ws,"initiate_handshake",{secure_web:_}):this._send_with_ws(t.ws,"initiate_handshake"))},e.prototype._fetch_unity_nonce=function(t,n){return t.state===e._VERSION_CHECK_STATE?(t.state=e._FETCHING_NONCE_STATE,this.logger.report_event("handshake_fetch_nonce"),this._retrieve_unity_nonce(t,n.nonce_key)):this._terminate_handshake(t.ws,"Fetch Unity nonce at wrong time of protocol.")},e.prototype._retrieve_unity_nonce=function(t,n){var _=this;return i.WebRequest({url:new h.URI({path:"/retrieve_unity_nonce"}),dataType:"json",data:{nonce_key:n},success:function(n){switch(n.status){case"OK":if(t.state=e._NONCE_RETURNED_TO_CLIENT_STATE,t.client_version>=o.default.PORT_CHECK&&(d.assert(n.message.client_port,"Port check must happen in version "+t.client_version),n.message.client_port!==t.port))return void _._terminate_handshake(t.ws,"Mismatched ports.",{client_port:n.message.client_port,web_port:t.port});t.client_has_auth=n.message.client_has_auth;var i=l.Viewer.get_viewer().is_signed_in;return t.client_has_auth&&i?_._permission_level=e.SECURE_PERMISSION:(d.assert(t.client_version>=o.default.PERMISSION_LEVELS,"Insecure connections only supported by client_version >= "+o.default.PERMISSION_LEVELS+"."),_._permission_level=t.client_has_auth?e.INSECURE_WEB_PERMISSION:i?e.INSECURE_CLIENT_PERMISSION:e.INSECURE_PERMISSION),_.logger.update({unity_permission_level:_._permission_level}),_.logger.report_event("handshake_nonce_sent_to_unity_server"),_._send_with_ws(t.ws,"verify_unity_nonce",{nonce:n.message.nonce});case"MISMATCHED_USER_IDS":return _._terminate_handshake(t.ws,"Mismatched user_ids.",{client_user_ids:n.message.client_user_ids,web_user_ids:n.message.web_user_ids});case"INVALID":return _._terminate_handshake(t.ws,"Could not find nonce with given nonce_key.");case"AUTH_REQUIRED":return _._terminate_handshake(t.ws,"Did not have the necessary authentication to retrieve nonce.");case"LOCAL_INFORMATION_PERMISSION_REQUIRED":return _._terminate_handshake(t.ws,"Did not have permission to start a local-information-allowed connection.")}},error:function(e,n,i){return _._terminate_handshake(t.ws,"Unable to retrieve nonce from server",{status:n,error_string:i})}})},e.prototype._complete_handshake=function(t,n){if(t.state===e._NONCE_RETURNED_TO_CLIENT_STATE&&n.is_success){if(t.state=e._HANDSHAKE_COMPLETED_STATE,this._connection_state===e._CONNECTION_CLOSED)return this._terminate_handshake(t.ws,"No more handshakes are allowed to complete.");if(null!=this._ws){var _="Only one Unity handshake can succeed! There's likely a MITM attack, so close all connections.";return this._terminate_handshake(t.ws,_),this._terminate_handshake(this._ws,_),this.client_version=null,this._ws=null,this._port=null,this._set_connection_state(e._CONNECTION_CLOSED)}return this.client_version=t.client_version,this._ws=t.ws,this._port=t.port,this._set_connection_state(e._CONNECTION_ESTABLISHED)}return this._terminate_handshake(t.ws,"Unable to complete handshake.")},e.prototype._terminate_handshake=function(e,t,n){void 0===n&&(n=null);var i={message:t};if(null!=n&&_.default.extend(i,n),c.UNITY_WEB_DEBUG&&console.error(i),this.logger.report_event("unity_failure",i),e)return e.close()},e.prototype._is_connection_in_progress=function(t){return t===e._CONNECTION_PENDING||t===e._CONNECTION_RETRYING},e.prototype.add_on_open_callback=function(e){return this._on_open_callbacks.push(e)},e.prototype.add_on_open_failed_callback=function(e){return this._on_open_failed_callbacks.push(e)},e.prototype.add_on_close_callback=function(e){return this._on_close_callbacks.push(e)},e.prototype.call_when_ready=function(e,t){return void 0===t&&(t=null),this.is_ready()?e():this._is_connection_in_progress(this._connection_state)?this._pending_callbacks.push([e,t]):"function"==typeof t?t(r.default.CONNECTION_CLOSED):void 0},e.prototype.is_ready=function(){return(null!=this._ws?this._ws.readyState:void 0)===WebSocket.OPEN&&this._connection_state===e._CONNECTION_ESTABLISHED},e.prototype.feature_supported=function(e,t){return d.assert(null!==this._permission_level,"Connection is not ready."),!(this.client_version<e)&&Array.from(t).includes(this._permission_level)},e})();f.initClass();return a.default.web_sockets_supported()?f:void 0}),define("modules/clean/unity/connection_error",["require","exports"],function(e,t){"use strict";var n=(function(){function e(){}return e.initClass=function(){this.CONNECTION_TIMEOUT="connection_timeout",this.CONNECTION_CLOSED="connection_closed",this.COULD_NOT_SEND="could_not_send",this.UNEXPECTED_ERROR="unexpected_error"},e})();return n.initClass(),n}),define("modules/clean/unity/features",["require","exports","tslib","jquery","modules/clean/ajax","modules/clean/filepath","modules/clean/unity/connection","modules/clean/unity/versions","modules/core/exception","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,_,i,r,s,o,a,u,l,c){"use strict";_=n.__importDefault(_),i=n.__importStar(i),r=n.__importStar(r),s=n.__importDefault(s),o=n.__importDefault(o),a=n.__importStar(a);var d=(function(){function e(){}return e.initClass=function(){this._uc=new s.default,this._has_handshake_started=!1,this._cached_file_browser_display_name=null},e._start_handshake_if_needed=function(){if(!this._has_handshake_started)return this._uc.start(),this._has_handshake_started=!0},e.continue_as_user=function(e,t,n,_){var i=this;return void 0===_&&(_=null),this._start_handshake_if_needed(),this._uc.call_when_ready(function(){if(i._uc.feature_supported(o.default.WEB_DESTINY,[s.default.INSECURE_WEB_PERMISSION]))return i._uc.logger.report_event("continue_as_user",{browser:e,refresh_token:t}),i._uc.send("continue_as_user",{browser:e,refresh_token:t},n,_)},_)},e.continue_as_user_direct=function(e,t){var n=this;return void 0===t&&(t=null),this._start_handshake_if_needed(),this._uc.call_when_ready(function(){if(n._uc.feature_supported(o.default.WEB_DESTINY_V2,[s.default.INSECURE_WEB_PERMISSION]))return n._uc.logger.report_event("continue_as_user_direct"),n._uc.send("continue_as_user_direct",null,e,t)},t)},e.web_destiny_info=function(e,t){var n=this;return void 0===t&&(t=null),this._start_handshake_if_needed(),this._uc.call_when_ready(function(){if(n._uc.feature_supported(o.default.WEB_DESTINY_V2,[s.default.INSECURE_WEB_PERMISSION]))return n._uc.logger.report_event("web_destiny_info"),n._uc.send("web_destiny_info",null,e,t)},t)},e.client_supports_open_in_file_browser=function(){return this._uc.feature_supported(o.default.OPEN_IN_FILE_BROWSER,[s.default.SECURE_PERMISSION])},e.open_file=function(e,t,n,_,u,l){var d=this;void 0===u&&(u=null),void 0===l&&(l=!1),this._start_handshake_if_needed();var h=this.server_path(e,t);return this._uc.call_when_ready(function(){if(d._uc.feature_supported(o.default.UNITY_HANDSHAKE,[s.default.SECURE_PERMISSION])){d._uc.logger.report_event("open_file",{user_id:n,path_id:h,file_extension:r.file_extension(h),in_file_browser:l}),i.SilentBackgroundRequest({url:new c.URI({path:"/unity_open_log"}),data:{user_id:n,server_path:h,file_extension:r.file_extension(h),in_file_browser:l,unity_session_id:d._uc.logger.unity_session_id(),buildno:d._uc.logger._data.buildno,host_id:d._uc.logger._data.host_id}});var e={server_path:h,user_id:n};return d._uc.client_version>=o.default.OPEN_IN_FILE_BROWSER?e.in_file_browser=l:a.assert(!l,"The connected client doesn't support opening in file browser."),d._uc.send("open_file",e,_,u)}},u)},e.standard_open_file_handler=function(e){if(!e)return l.Notify.error(u._("Error opening file"))},e.check_file=function(e,t,n,_,i){var a=this;void 0===i&&(i=null),this._start_handshake_if_needed();var u=this.server_path(e,t),l=function(e){return a._check_file_deprecated_on_client()&&(e={is_locally_available:e}),_(e)};return this._uc.call_when_ready(function(){if(a._uc.feature_supported(o.default.UNITY_HANDSHAKE,[s.default.SECURE_PERMISSION]))return a._uc.logger.report_event("check_file",{user_id:n,path_id:u,file_extension:r.file_extension(u)}),a._uc.send("check_file",{server_path:u,user_id:n},l,i)},i)},e.add_on_ready_callback=function(e){return this._uc.call_when_ready(e)},e.check_file_batch=function(e,t,n,i){var a=this;void 0===i&&(i=null);var u=_.default.Deferred();this._start_handshake_if_needed();var l=Array.from(e).map(function(e){return a.server_path(e.ns_id,e.ns_path)}),c=function(e){if(a._check_file_deprecated_on_client())for(var t in e){var _=e[t];e[t]={is_locally_available:_}}return"function"==typeof n&&n(e),u.resolve(e)},d=function(e){return"function"==typeof i&&i(e),u.reject(e)};return this._uc.call_when_ready(function(){if(a._uc.feature_supported(o.default.UNITY_HANDSHAKE,[s.default.SECURE_PERMISSION]))return a._uc.logger.report_event("check_file_batch",{user_id:t,path_ids:l,file_extensions:Array.from(l).map(function(e){return r.file_extension(e)})}),a._uc.send("check_file_batch",{server_paths:l,user_id:t},c,d)},d),u.promise()},e.file_browser_display_name=function(e,t){var n=this;if(void 0===t&&(t=null),null!=this._cached_file_browser_display_name)return void e(this._cached_file_browser_display_name);var _=function(t){return n._cached_file_browser_display_name=t,e(t)};this._start_handshake_if_needed();var i=function(){return n._uc.feature_supported(o.default.CHECK_FILE_RETURNS_OBJ,[s.default.SECURE_PERMISSION])?(n._uc.logger.report_event("file_browser_display_name"),n._uc.send("file_browser_display_name",null,_,t)):e(null)};return this._uc.call_when_ready(i,t)},e._check_file_deprecated_on_client=function(){return o.default.UNITY_HANDSHAKE<=this._uc.client_version&&this._uc.client_version<o.default.CHECK_FILE_RETURNS_OBJ},e.server_path=function(e,t){return e+":"+t},e.has_chime=function(e,t){var n=this;void 0===t&&(t=null),this._start_handshake_if_needed();var _=function(){if(n._uc.feature_supported(o.default.CHIME_OPEN,[s.default.SECURE_PERMISSION]))return n._uc.logger.report_event("has_chime"),n._uc.send("has_chime",null,e,t)};return this._uc.call_when_ready(_,t)},e.open_chime=function(e,t,n){var _=this;void 0===n&&(n=null),this._start_handshake_if_needed();var i=function(){if(_._uc.feature_supported(o.default.CHIME_OPEN,[s.default.SECURE_PERMISSION]))return _._uc.logger.report_event("open_chime",{parameters:e}),_._uc.send("open_chime",e,t,n)};return this._uc.call_when_ready(i,n)},e.growth_deep_link=function(e,t){var n=this;return void 0===t&&(t={}),new Promise(function(_,i){n._start_handshake_if_needed(),n._uc.call_when_ready(function(){if(n._uc.feature_supported(o.default.GROWTH_DEEP_LINK,[s.default.SECURE_PERMISSION]))return n._uc.logger.report_event("growth_deep_link"),n._uc.send("growth_deep_link",{resource:e,data:t},_,i);i("featured_unsupported")},i)})},e.has_desktop_client=function(e){var t=this;this._start_handshake_if_needed();var n=function(){t._uc.feature_supported(o.default.OPEN_IN_FILE_BROWSER,[s.default.SECURE_PERMISSION])&&e()};return this._uc.call_when_ready(n)},e})();d.initClass();return null==s.default?void 0:d}),define("modules/clean/unity/flash_config",["require","exports","tslib","modules/clean/unity/websocket_config","modules/constants/static","modules/constants/unity"],function(e,t,n,_,i,r){"use strict";return _=n.__importDefault(_),i=n.__importStar(i),r=n.__importStar(r),window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0,window.DefaultWebSocket=window.WebSocket,_.default.useFlashShim()&&(window.WEB_SOCKET_FORCE_FLASH=!0),window.WEB_SOCKET_SWF_LOCATION=i.static_url_web_socket_swf,r.UNITY_WEB_DEBUG||(window.WEB_SOCKET_LOGGER={log:function(){},error:function(){}}),null}),define("modules/clean/unity/logger",["require","exports","tslib","jquery","modules/clean/ajax","modules/clean/unity/versions","modules/constants/unity","modules/core/uri"],function(e,t,n,_,i,r,s,o){"use strict";return _=n.__importDefault(_),i=n.__importStar(i),r=n.__importDefault(r),s=n.__importStar(s),(function(){function e(){this._data={logging_source:"web",web_unity_version:r.default.LATEST}}return e.prototype.update=function(e){return _.default.extend(this._data,e)},e.prototype.report_event=function(e,t){if(void 0===t&&(t=null),this._data.event_name=e,this._data.local_ts=(new Date).getTime()/1e3,this._data.extra=JSON.stringify(t||{}),i.SilentBackgroundRequest({url:new o.URI({path:"/unity_connection_log"}),data:this._data}),s.UNITY_WEB_DEBUG)return console.log(this._data)},e.prototype.get_log_data_for_client=function(){return{web_unity_version:this._data.web_unity_version,user_agent:window.navigator.userAgent}},e.prototype.unity_session_id=function(){return this._data.unity_session_id},e})()}),define("modules/clean/unity/versions",["require","exports"],function(e,t){"use strict";var n=(function(){function e(){}return e.initClass=function(){this.LATEST=10,this.INITIAL_UNITY=1,this.UNITY_HANDSHAKE=2,this.REUNITY=3,this.OPEN_IN_FILE_BROWSER=4,this.CHECK_FILE_RETURNS_OBJ=5,this.PERMISSION_LEVELS=6,this.WEB_DESTINY=7,this.WEB_DESTINY_V2=8,this.PORT_CHECK=9,this.CHIME_OPEN=10,this.GROWTH_DEEP_LINK=15},e})();return n.initClass(),n}),define("modules/clean/unity/web_socket",["require","exports","tslib","external/web_socket","modules/clean/unity/logger","modules/clean/unity/websocket_config"],function(e,t,n,_,i,r){"use strict";_=n.__importDefault(_),i=n.__importDefault(i),r=n.__importDefault(r);return(function(){function e(){}return e.create=function(e){return"function"==typeof _.default.__initialize&&_.default.__initialize(),new _.default(e)},e.load_flash_policy_if_needed=function(){var e=new i.default;if(null!=(null!=_.default?_.default.loadFlashPolicyFile:void 0))e.report_event("load_flash_policy_file"),_.default.loadFlashPolicyFile("xmlsocket://127.0.0.1:17603");else{if(r.default.useFlashShim())return e.report_event("unity_failure",{message:"Could not use WebSockets."}),!1;e.report_event("using_default_web_socket")}return!0},e.web_sockets_supported=function(){return null!=_.default},e})()}),define("modules/clean/unity/websocket_config",["require","exports","tslib","external/flash_detect","modules/core/browser"],function(e,t,n,_,i){"use strict";return _=n.__importDefault(_),i=n.__importStar(i),(function(){function e(){}return e.useFlashShim=function(){return this.canFlashPolyfillWebSocket()&&!this.canBrowserSupportNonSecureWebsocket()},e.canUnityConnect=function(){return this.canFlashPolyfillWebSocket()||this.canBrowserSupportNonSecureWebsocket()},e.canFlashPolyfillWebSocket=function(){return _.default.versionAtLeast(10,3)},e.canBrowserSupportNonSecureWebsocket=function(){var e=parseInt(i.version,10);return!!(i.safari&&e<9)||!!(i.chrome&&e>=53)},e})()});
//# sourceMappingURL=pkg-unity.min.js-vflBEt20P.map