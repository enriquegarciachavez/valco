define(["require","exports","tslib","external/react","modules/clean/downloads","modules/clean/multiaccount_login","modules/clean/react/copy_to_dropbox/modal","modules/clean/react/modal","modules/clean/react/share_download/api","modules/clean/sharing/signup_modal_proxy","modules/clean/viewer","modules/core/browser","modules/core/exception","modules/core/i18n","modules/core/notify","modules/clean/react/share_download/api"],function(e,r,o,n,t,a,s,l,i,u,c,d,_,m,p,f){"use strict";function w(e){return o.__awaiter(this,void 0,void 0,function(){var r,n,a,s,l;return o.__generator(this,function(o){switch(o.label){case 0:return r=e.downloadTestUrl,n=e.url,[4,u.signupModalProxy.signupForDirectDownload()];case 1:if(o.sent(),!r)return[3,5];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,i.testDownload(r)];case 3:return o.sent(),[3,5];case 4:return a=o.sent(),a instanceof f.TooLargeError?p.Notify.error(m._("The zip file is too large.")):p.Notify.error(m._("Failed to download zip file.")),[2];case 5:return o.trys.push([5,7,,8]),[4,i.fetchDownloadUrl(n)];case 6:return s=o.sent(),t.get({url:s}),[3,8];case 7:return l=o.sent(),p.Notify.error(m._("Failed to download.")),[3,8];case 8:return[2]}})})}function h(e,r,t,i){return o.__awaiter(this,void 0,void 0,function(){var m,p,f;return o.__generator(this,function(o){switch(o.label){case 0:return"anonymous"!==t?[3,2]:[4,u.signupModalProxy.signup()];case 1:return m=o.sent(),p=d.reload,[3,4];case 2:return m=i?i.id:-1,_.assert(m!==-1,"role isn't anonymous => user cannot be null or undefined!"),f=c.Viewer.get_viewer(),f.is_user_signed_in(i)?[3,4]:[4,new Promise(function(e){a.default.show_modal({role:t,on_success:e})})];case 3:o.sent(),o.label=4;case 4:return l.Modal.showInstance(n.createElement(s.CopyToDropboxModal,{shareToken:e,copyable:r,userId:m,role:t,onDismiss:p})),[2]}})})}Object.defineProperty(r,"__esModule",{value:!0}),n=o.__importStar(n),t=o.__importStar(t),a=o.__importDefault(a),i=o.__importStar(i),d=o.__importStar(d),r.direct=w,r.toDropbox=h});
//# sourceMappingURL=actions.min.js-vflMRhUnX.map