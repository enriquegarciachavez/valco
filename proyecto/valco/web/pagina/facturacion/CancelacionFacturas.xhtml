<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <body>

        <ui:composition template="./../templates/Template1.xhtml">

            <ui:define name="title">
                Cancelación de facturas
            </ui:define>

            <ui:define name="content" >
                <p:messages id="messages" showDetail="true" autoUpdate="true" />
                <h:form id="formBusqueda">
                    <h:panelGrid columns="2"
                                 cellpadding="5"
                                 cellspacing="5"
                                 style="text-align: right; margin: 0 auto;" >
                                     
                        <p:outputLabel for="noFactura" value="Número de factura:"  />
                        <p:inputText id="noFactura"
                                     value="#{cancelacionFacturaBean.noFactura}"/>
                        
                        <p:outputLabel for="noNota" value="Número de nota:"  />
                        <p:inputText id="noNota"
                                     value="#{cancelacionFacturaBean.noNota}"/>
                        <f:facet name="footer">
                            <p:commandButton id="btnBuscar"
                                             value="Buscar"
                                             action="#{cancelacionFacturaBean.buscar()}"
                                             update=":formTabla"/>
                        </f:facet>
                        
                    </h:panelGrid>
                </h:form>
                
                <h:form id="formTabla">
                    <p:menubar>

                        <p:menuitem 
                            id="btnCancelar"
                            value="Cancelar" 
                            icon="ui-icon-circle-close"
                            partialSubmit="true"
                            action="#{cancelacionFacturaBean.cancelar()}"
                            
                           /> 
                    </p:menubar>
                    <p:dataTable id="tablaFacturas"
                                 var="fact"
                                 rowKey="#{fact.codigo}"
                                 value="#{cancelacionFacturaBean.facturasDisponibles}"
                                 selection="#{cancelacionFacturaBean.facturaSeleccionada}"
                                 selectionMode="single">
                        
                        <p:column headerText="Factura"> 
                             <h:outputText value="#{fact.codigo}" />
                        </p:column>
                        <p:column headerText="Nota">   
                             <h:outputText value="#{fact.notasDeVenta.folio}" />
                        </p:column>
                        <p:column headerText="Fecha">  
                             <h:outputText value="#{fact.fecha}" />
                        </p:column>
                        <p:column headerText="Total">  
                            <h:outputText value="#{fact.total}" />
                        </p:column>
                        
                    </p:dataTable>
                </h:form>
                
                <p:blockUI block="formBusqueda formTabla" trigger="formBusqueda:btnBuscar formTabla:btnCancelar">
                        Cargando.... Espere porfavor<br />
                        <img src="../../resources/imagenes/Progress_bar.gif" alt=""/>

                </p:blockUI>
                
            </ui:define>

        </ui:composition>

    </body>
</html>
